import { useState } from 'react';
import { Navigate } from 'react-router-dom';

const LoginSignup = () => {
  const [showLogin, setShowLogin] = useState(true);
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [errorMsg,setErrorMsg]=useState('')
  const [name,setName]=useState('')
  const toggleView = () => {
    setShowLogin(!showLogin);
    setEmail('');
    setPassword('');
    setErrorMsg('')
    setName('')
  };
  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!email || !password) {
      setErrorMsg('Please fill all the fields');
      return;
    }
    try {
      const response = await fetch(`http://localhost:4000/user/${showLogin ? 'login' : 'register'}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password,name }),
      });
      if (response.ok) {

        const data = await response.json();
        console.log('Response Data:', data);
  
        // Check if there's an error in the response data
        if (data.error) {
          setErrorMsg(data.error);
          return;
        }
  
        // If no error, save data to localStorage
        localStorage.setItem('data', JSON.stringify(data));
      } else {
        // If response status is not OK, handle the error
        console.error('HTTP error:', response.status);
        setErrorMsg('Server Error');
      }
    } catch (error) {
      setErrorMsg(error.message);
    }
  };
  const handleGoogleLogin = () => {
    window.location.href = 'http://localhost:4000/auth/google'; 
  };
  
  return (
    <div className={`flex flex-col md:flex-row  h-screen w-full overflow-hidden  ${showLogin ? 'bg-[#010019] transition duration-1000 ease-in-out' : 'bg-white'}`}>
     <div className={`p-2 bg-white w-full md:w-1/2  ${showLogin ? 'translate-x-0' : 'translate-x-full'} transition-transform duration-500 ease-in-out`}>
        <form onSubmit={handleSubmit} className='gap-10 w-full flex flex-col items-center'>

        <div className='h-10 mt-10 flex items-center  md:gap-8'>
          <h3 className='text-black text-xl  '>Don't have an account?</h3>
          <button className='px-6 md:px-12 py-3 rounded-3xl ml-10 border border-[#797488] text-[#010019] hover:text-white hover:bg-[#010019] transition-colors duration-300' type='button' onClick={toggleView}>Sign Up</button>
        </div>
        
        <div className='flex flex-col  md:w-1/2'>
          <h1 className='text-black font-bold text-3xl '>Welcome to ALGChat</h1>
          <h3 className='text-black ml-1 text-xl'>Log in to your account</h3>
        </div>
        <input type="email" className='py-5 px-4 bg-[#F0F0F0] rounded-xl  w-1/2 outline-none text-black' placeholder='E-mail' onChange={(e) => setEmail(e.target.value)} value={email} />
        <div className=' w-1/2 flex flex-col'>
        <input type="password" className=' bg-[#F0F0F0] rounded-xl py-5 px-4  outline-none text-black' placeholder='Password' onChange={(e) => setPassword(e.target.value)} value={password} />
        <button className='text-[#010019] text-md ml-2 text-start '>Forget password ?</button>
        </div>

        {errorMsg && <p className='text-red-500  '>{errorMsg}</p>}

        <div className=' gap-4 w-full flex flex-col items-center mb-20'>
          <button className='py-4  text-white rounded-xl hover:bg-white hover:border hover:text-black hover:border-[#797488]  w-1/2 bg-[#010019] transition-colors duration-300' type='submit'>Log In</button>
         
          <button onClick={handleGoogleLogin} className='py-4 bg-white text-[#010019] rounded-xl w-1/2 border border-[#797488] hover:text-white hover:bg-[#010019]   hover:border hover:border-solid transition-colors duration-300 flex items-center justify-center'>
          <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="45" height="30" viewBox="0 0 48 48">
              <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
              <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
              <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
              <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
            </svg>Continue with Google</button>
        </div>
        
        </form>
      </div > 

     <div className={`absolute flex justify-center items-center w-1/2 ${showLogin ? 'md:translate-x-full' : 'md:translate-x-0'} transition-transform duration-500 bg-gren-200 h-full`}>
     <svg width="161" height="40" viewBox="0 0 161 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M19.9947 7.33813C18.0549 7.33991 16.1564 7.89864 14.5249 8.9479C12.8933 9.99716 11.5974 11.4928 10.7911 13.2571C9.98475 15.0214 9.70198 16.9801 9.97637 18.9005C10.2508 20.8208 11.0708 22.6219 12.3389 24.0898L20.0005 32.6619L27.6609 24.0898C28.9293 22.6216 29.7494 20.82 30.0236 18.8993C30.2979 16.9786 30.0147 15.0195 29.2078 13.255C28.4009 11.4906 27.1043 9.99496 25.4721 8.94604C23.8398 7.89712 21.9407 7.33903 20.0005 7.33813H19.9947ZM19.9947 27.482C19.8316 24.8795 18.7242 22.426 16.8803 20.5821C15.0364 18.7382 12.5829 17.6308 9.98036 17.4676C12.5829 17.3045 15.0364 16.197 16.8803 14.3532C18.7242 12.5093 19.8316 10.0558 19.9947 7.45324C20.1579 10.0558 21.2653 12.5093 23.1092 14.3532C24.9531 16.197 27.4066 17.3045 30.0091 17.4676C27.4072 17.6307 24.9541 18.7376 23.1103 20.5808C21.2665 22.424 20.1587 24.8766 19.9947 27.4786V27.482Z" fill="#16DB65"/>
<path d="M54.2266 19V19.625C54.2266 20.4844 54.1146 21.2552 53.8906 21.9375C53.6667 22.6198 53.3464 23.2005 52.9297 23.6797C52.5182 24.1589 52.0234 24.526 51.4453 24.7812C50.8672 25.0312 50.2266 25.1562 49.5234 25.1562C48.8255 25.1562 48.1875 25.0312 47.6094 24.7812C47.0365 24.526 46.5391 24.1589 46.1172 23.6797C45.6953 23.2005 45.3672 22.6198 45.1328 21.9375C44.9036 21.2552 44.7891 20.4844 44.7891 19.625V19C44.7891 18.1406 44.9036 17.3724 45.1328 16.6953C45.362 16.013 45.6849 15.4323 46.1016 14.9531C46.5234 14.4688 47.0208 14.1016 47.5938 13.8516C48.1719 13.5964 48.8099 13.4688 49.5078 13.4688C50.2109 13.4688 50.8516 13.5964 51.4297 13.8516C52.0078 14.1016 52.5052 14.4688 52.9219 14.9531C53.3385 15.4323 53.6589 16.013 53.8828 16.6953C54.112 17.3724 54.2266 18.1406 54.2266 19ZM52.2656 19.625V18.9844C52.2656 18.349 52.2031 17.7891 52.0781 17.3047C51.9583 16.8151 51.7786 16.4062 51.5391 16.0781C51.3047 15.7448 51.0156 15.4948 50.6719 15.3281C50.3281 15.1562 49.9401 15.0703 49.5078 15.0703C49.0755 15.0703 48.6901 15.1562 48.3516 15.3281C48.013 15.4948 47.724 15.7448 47.4844 16.0781C47.25 16.4062 47.0703 16.8151 46.9453 17.3047C46.8203 17.7891 46.7578 18.349 46.7578 18.9844V19.625C46.7578 20.2604 46.8203 20.8229 46.9453 21.3125C47.0703 21.8021 47.2526 22.2161 47.4922 22.5547C47.737 22.888 48.0286 23.1406 48.3672 23.3125C48.7057 23.4792 49.0911 23.5625 49.5234 23.5625C49.9609 23.5625 50.349 23.4792 50.6875 23.3125C51.026 23.1406 51.3125 22.888 51.5469 22.5547C51.7812 22.2161 51.9583 21.8021 52.0781 21.3125C52.2031 20.8229 52.2656 20.2604 52.2656 19.625ZM58.0406 18.1719V28.25H56.1578V16.5469H57.8922L58.0406 18.1719ZM63.5484 20.6953V20.8594C63.5484 21.474 63.4755 22.0443 63.3297 22.5703C63.1891 23.0911 62.9781 23.5469 62.6969 23.9375C62.4208 24.3229 62.0797 24.6224 61.6734 24.8359C61.2672 25.0495 60.7984 25.1562 60.2672 25.1562C59.7411 25.1562 59.2802 25.0599 58.8844 24.8672C58.4937 24.6693 58.163 24.3906 57.8922 24.0312C57.6214 23.6719 57.4026 23.25 57.2359 22.7656C57.0745 22.276 56.9599 21.7396 56.8922 21.1562V20.5234C56.9599 19.9036 57.0745 19.3411 57.2359 18.8359C57.4026 18.3307 57.6214 17.8958 57.8922 17.5312C58.163 17.1667 58.4937 16.8854 58.8844 16.6875C59.275 16.4896 59.7307 16.3906 60.2516 16.3906C60.7828 16.3906 61.2542 16.4948 61.6656 16.7031C62.0771 16.9062 62.4234 17.1979 62.7047 17.5781C62.9859 17.9531 63.1969 18.4062 63.3375 18.9375C63.4781 19.4635 63.5484 20.0495 63.5484 20.6953ZM61.6656 20.8594V20.6953C61.6656 20.3047 61.6292 19.9427 61.5562 19.6094C61.4833 19.2708 61.3687 18.974 61.2125 18.7188C61.0562 18.4635 60.8557 18.2656 60.6109 18.125C60.3714 17.9792 60.0823 17.9062 59.7437 17.9062C59.4104 17.9062 59.124 17.9635 58.8844 18.0781C58.6448 18.1875 58.4443 18.3411 58.2828 18.5391C58.1214 18.737 57.9964 18.9688 57.9078 19.2344C57.8193 19.4948 57.7568 19.7786 57.7203 20.0859V21.6016C57.7828 21.9766 57.8896 22.3203 58.0406 22.6328C58.1917 22.9453 58.4052 23.1953 58.6812 23.3828C58.9625 23.5651 59.3219 23.6562 59.7594 23.6562C60.0979 23.6562 60.387 23.5833 60.6266 23.4375C60.8661 23.2917 61.0615 23.0911 61.2125 22.8359C61.3687 22.5755 61.4833 22.276 61.5562 21.9375C61.6292 21.599 61.6656 21.2396 61.6656 20.8594ZM69.175 16.5469V17.9219H64.4094V16.5469H69.175ZM65.7844 14.4766H67.6672V22.6641C67.6672 22.9245 67.7036 23.125 67.7766 23.2656C67.8547 23.401 67.9615 23.4922 68.0969 23.5391C68.2323 23.5859 68.3911 23.6094 68.5734 23.6094C68.7036 23.6094 68.8286 23.6016 68.9484 23.5859C69.0682 23.5703 69.1646 23.5547 69.2375 23.5391L69.2453 24.9766C69.0891 25.0234 68.9068 25.0651 68.6984 25.1016C68.4953 25.138 68.2609 25.1562 67.9953 25.1562C67.563 25.1562 67.1802 25.0807 66.8469 24.9297C66.5135 24.7734 66.2531 24.5208 66.0656 24.1719C65.8781 23.8229 65.7844 23.3594 65.7844 22.7812V14.4766ZM72.7938 16.5469V25H70.9031V16.5469H72.7938ZM70.7781 14.3281C70.7781 14.0417 70.8719 13.8047 71.0594 13.6172C71.2521 13.4245 71.5177 13.3281 71.8563 13.3281C72.1896 13.3281 72.4526 13.4245 72.6453 13.6172C72.838 13.8047 72.9344 14.0417 72.9344 14.3281C72.9344 14.6094 72.838 14.8438 72.6453 15.0312C72.4526 15.2188 72.1896 15.3125 71.8563 15.3125C71.5177 15.3125 71.2521 15.2188 71.0594 15.0312C70.8719 14.8438 70.7781 14.6094 70.7781 14.3281ZM77.4281 25H75.5375V16C75.5375 15.3177 75.6729 14.7422 75.9438 14.2734C76.2198 13.8047 76.613 13.4479 77.1234 13.2031C77.6391 12.9583 78.251 12.8359 78.9594 12.8359C79.376 12.8359 79.7771 12.8802 80.1625 12.9688C80.5531 13.0573 80.9568 13.1693 81.3734 13.3047L81.0844 14.8359C80.8188 14.7474 80.5245 14.6641 80.2016 14.5859C79.8786 14.5026 79.5063 14.4609 79.0844 14.4609C78.5167 14.4609 78.0974 14.5911 77.8266 14.8516C77.5609 15.1068 77.4281 15.4896 77.4281 16V25ZM79.1234 16.5469V17.9219H74.2406V16.5469H79.1234ZM82.2641 16.5469V25H80.3813V16.5469H82.2641ZM88.2422 25.1562C87.6172 25.1562 87.0521 25.0547 86.5469 24.8516C86.0469 24.6432 85.6198 24.3542 85.2656 23.9844C84.9167 23.6146 84.6484 23.1797 84.4609 22.6797C84.2734 22.1797 84.1797 21.6406 84.1797 21.0625V20.75C84.1797 20.0885 84.276 19.4896 84.4688 18.9531C84.6615 18.4167 84.9297 17.9583 85.2734 17.5781C85.6172 17.1927 86.0234 16.8984 86.4922 16.6953C86.9609 16.4922 87.4688 16.3906 88.0156 16.3906C88.6198 16.3906 89.1484 16.4922 89.6016 16.6953C90.0547 16.8984 90.4297 17.1849 90.7266 17.5547C91.0286 17.9193 91.2526 18.3542 91.3984 18.8594C91.5495 19.3646 91.625 19.9219 91.625 20.5312V21.3359H85.0938V19.9844H89.7656V19.8359C89.7552 19.4974 89.6875 19.1797 89.5625 18.8828C89.4427 18.5859 89.2578 18.3464 89.0078 18.1641C88.7578 17.9818 88.4245 17.8906 88.0078 17.8906C87.6953 17.8906 87.4167 17.9583 87.1719 18.0938C86.9323 18.224 86.7318 18.4141 86.5703 18.6641C86.4089 18.9141 86.2839 19.2161 86.1953 19.5703C86.112 19.9193 86.0703 20.3125 86.0703 20.75V21.0625C86.0703 21.4323 86.1198 21.776 86.2188 22.0938C86.3229 22.4062 86.474 22.6797 86.6719 22.9141C86.8698 23.1484 87.1094 23.3333 87.3906 23.4688C87.6719 23.599 87.9922 23.6641 88.3516 23.6641C88.8047 23.6641 89.2083 23.5729 89.5625 23.3906C89.9167 23.2083 90.224 22.9505 90.4844 22.6172L91.4766 23.5781C91.2943 23.8438 91.0573 24.099 90.7656 24.3438C90.474 24.5833 90.1172 24.7786 89.6953 24.9297C89.2786 25.0807 88.7943 25.1562 88.2422 25.1562ZM95.2594 13V25H93.3688V13H95.2594ZM102.628 23.25V13H104.519V25H102.808L102.628 23.25ZM97.1281 20.8672V20.7031C97.1281 20.0625 97.2036 19.4792 97.3547 18.9531C97.5057 18.4219 97.7245 17.9661 98.0109 17.5859C98.2974 17.2005 98.6464 16.9062 99.0578 16.7031C99.4693 16.4948 99.9328 16.3906 100.448 16.3906C100.959 16.3906 101.407 16.4896 101.792 16.6875C102.178 16.8854 102.506 17.1693 102.777 17.5391C103.047 17.9036 103.264 18.3411 103.425 18.8516C103.586 19.3568 103.701 19.9193 103.769 20.5391V21.0625C103.701 21.6667 103.586 22.2188 103.425 22.7188C103.264 23.2188 103.047 23.651 102.777 24.0156C102.506 24.3802 102.175 24.6615 101.784 24.8594C101.399 25.0573 100.948 25.1562 100.433 25.1562C99.9224 25.1562 99.4615 25.0495 99.05 24.8359C98.6437 24.6224 98.2974 24.3229 98.0109 23.9375C97.7245 23.5521 97.5057 23.099 97.3547 22.5781C97.2036 22.0521 97.1281 21.4818 97.1281 20.8672ZM99.0109 20.7031V20.8672C99.0109 21.2526 99.0448 21.612 99.1125 21.9453C99.1854 22.2786 99.2974 22.5729 99.4484 22.8281C99.5995 23.0781 99.7948 23.276 100.034 23.4219C100.279 23.5625 100.571 23.6328 100.909 23.6328C101.336 23.6328 101.688 23.5391 101.964 23.3516C102.24 23.1641 102.456 22.9115 102.612 22.5938C102.774 22.2708 102.883 21.9115 102.941 21.5156V20.1016C102.909 19.7943 102.844 19.5078 102.745 19.2422C102.652 18.9766 102.524 18.7448 102.362 18.5469C102.201 18.3438 102.001 18.1875 101.761 18.0781C101.527 17.9635 101.248 17.9062 100.925 17.9062C100.581 17.9062 100.29 17.9792 100.05 18.125C99.8104 18.2708 99.6125 18.4714 99.4562 18.7266C99.3052 18.9818 99.1932 19.2786 99.1203 19.6172C99.0474 19.9557 99.0109 20.3177 99.0109 20.7031Z" fill="#1C1A25"/>
</svg>

     </div>
     <div className={`p-2 bg-[#010019]   w-full md:w-1/2 flex flex-col items-center ${showLogin ? 'md:translate-x-full' : 'md:translate-x-0'} transition-transform duration-500 ease-in-out`}>
     <form onSubmit={handleSubmit} className='gap-10 w-full flex flex-col items-center'>
        <div className='h-10 mt-10  flex items-center gap-8 '>
          <h3 className='text-white text-lg'>Already have an account ?</h3>
          <button className='px-12 py-3 rounded-3xl border border-white  text-white  hover:bg-white transition-colors duration-300'  onClick={toggleView} type='button'>Login</button>
        </div>
        <div className='flex flex-col w-3/4 ml-10'>
          <h1 className='text-white font-bold text-3xl '>Welcome to ALGChat</h1>
          <h3 className='text-white text-xl ml-1'>Register your account</h3>
        </div>
        <input type="text" className='py-5 px-4 bg-[#F0F0F0] text-lg rounded-xl w-3/5 outline-none flex items-center  text-black mr-20' placeholder='Name' onChange={(e) => setName(e.target.value)} value={name} />
        <input type="email" className='py-5 px-4 bg-[#F0F0F0] text-lg  rounded-xl w-3/5 flex items-center outline-none  text-black mr-20' placeholder='E-mail' onChange={(e) => setEmail(e.target.value)} value={email} />
        <input type="password" className='py-5 px-4 bg-[#F0F0F0] text-lg rounded-xl w-3/5 outline-none flex items-center  text-black mr-20' placeholder='Password' onChange={(e) => setPassword(e.target.value)} value={password} />
        {errorMsg && <p className='text-red-500 text-center mr-20 '>{errorMsg}</p>} 
        <div className='flex flex-col gap-3 w-full items-center mt-5'>
          <button className='py-4 bg-[#FF4A09] text-white  rounded-xl w-3/5 mr-20 hover:text-[#010019] hover:bg-white hover:border hover:border-white hover:border-solid transition-colors duration-300' onClick={handleSubmit}> Sign Up</button>
         
          <button onClick={handleGoogleLogin} className='py-4  border border-white rounded-xl bg-white   w-3/5 flex justify-center items-center mr-20 text-black hover:text-white hover:bg-[#FF4A09] transition-colors duration-300'>
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="45" height="30" viewBox="0 0 48 48">
              <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
              <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
              <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
              <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
            </svg>
            Continue with Google
          </button>
        </div>
    </form>
      </div>
    </div>
  );
};
export default LoginSignup;
